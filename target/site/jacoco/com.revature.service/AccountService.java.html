<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AccountService.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">ProjectZeroFullStack</a> &gt; <a href="index.source.html" class="el_package">com.revature.service</a> &gt; <span class="el_source">AccountService.java</span></div><h1>AccountService.java</h1><pre class="source lang-java linenums">package com.revature.service;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

import com.revature.util.ConnectionUtil;
import com.revature.dao.AccountRepository;
import com.revature.dto.PostAccountDTO;
import com.revature.exceptions.AccountNotFoundException;
import com.revature.exceptions.AddAccountException;
import com.revature.exceptions.BadParameterException;
import com.revature.exceptions.DatabaseException;
import com.revature.exceptions.NotRealtorsAccountException;
import com.revature.exceptions.RealtorNotFoundException;
import com.revature.model.Account;

public class AccountService {
	
	private AccountRepository accountRepository;
	
<span class="nc" id="L22">	String accountWithIdOf = &quot;Account with Id of &quot;;</span>
<span class="nc" id="L23">	String and = &quot; and &quot;;</span>
<span class="nc" id="L24">	String realtorIdMustBeAnIntUserProvided = &quot;Realtor Id must be an int. User provided &quot;;</span>
<span class="nc" id="L25">	String realtorIdAndAccountIdMustBeAnIntUserProvided = &quot;Realtor Id and Account Id must be an int. User provided &quot;;</span>
<span class="nc" id="L26">	String realtorWithIdOf = &quot;Realtor with Id of &quot;;</span>
<span class="nc" id="L27">	String wasNotFound = &quot; was not found.&quot;;</span>
	
<span class="nc" id="L29">	public AccountService() {</span>
<span class="nc" id="L30">		this.accountRepository = new AccountRepository();</span>
<span class="nc" id="L31">	}</span>
	
<span class="nc" id="L33">	public AccountService(AccountRepository accountRepository) {</span>
<span class="nc" id="L34">		this.accountRepository = accountRepository;</span>
<span class="nc" id="L35">	}</span>
	
	public Account addAccount(String stringId, PostAccountDTO accountDTO) throws BadParameterException, DatabaseException, AddAccountException {
		try {
<span class="nc" id="L39">			Connection connection = ConnectionUtil.getConnection();</span>
<span class="nc" id="L40">			this.accountRepository.setConnection(connection);</span>
<span class="nc" id="L41">			connection.setAutoCommit(false);</span>
			
<span class="nc bnc" id="L43" title="All 2 branches missed.">			if (accountDTO.getAccountType().trim().equals(&quot;&quot;)) {</span>
<span class="nc" id="L44">				throw new AddAccountException(&quot;Account types cannot be blank&quot;);</span>
			}
			
			try {
<span class="nc" id="L48">				int realtorId = Integer.parseInt(stringId);</span>
				
<span class="nc" id="L50">				Account account = accountRepository.addAccount(realtorId, accountDTO);</span>
				
<span class="nc" id="L52">				connection.commit();</span>
<span class="nc" id="L53">				return account;</span>
<span class="nc" id="L54">			} catch (NumberFormatException e) {</span>
<span class="nc" id="L55">				throw new BadParameterException(realtorIdMustBeAnIntUserProvided + stringId);</span>
			}
			
<span class="nc" id="L58">		} catch (SQLException e) {</span>
<span class="nc" id="L59">			throw new DatabaseException(&quot;Something went wrong when trying to get a connection. &quot;</span>
<span class="nc" id="L60">					+ &quot;Exception message: &quot; + e.getMessage());</span>
		}

	}
	
	public List&lt;Account&gt; getAccounts(String stringId) throws AccountNotFoundException, DatabaseException, BadParameterException, RealtorNotFoundException {
		try {
<span class="nc" id="L67">			int id = Integer.parseInt(stringId);</span>
			
<span class="nc" id="L69">			List&lt;Account&gt; accounts = accountRepository.getAccounts(id);	</span>
			
<span class="nc bnc" id="L71" title="All 2 branches missed.">			if (stringId == null) {</span>
<span class="nc" id="L72">				throw new RealtorNotFoundException(realtorWithIdOf + id + wasNotFound);</span>
			}
			
<span class="nc bnc" id="L75" title="All 2 branches missed.">			if (accounts == null) {</span>
<span class="nc" id="L76">				throw new AccountNotFoundException(&quot;There are no accounts in the database&quot;);</span>
			}
			
<span class="nc" id="L79">			return accountRepository.getAccounts(id);</span>
<span class="nc" id="L80">		} catch (NumberFormatException e) {</span>
<span class="nc" id="L81">			throw new BadParameterException(realtorIdMustBeAnIntUserProvided + stringId);</span>
		}
	}
	
	public List&lt;Account&gt; getAccountsSpecial(String stringId, String aLT, String aGT) throws AccountNotFoundException, DatabaseException, BadParameterException, RealtorNotFoundException {
		try {
<span class="nc" id="L87">			int id = Integer.parseInt(stringId);</span>
<span class="nc" id="L88">			double lessThan = Double.parseDouble(aLT);</span>
<span class="nc" id="L89">			double greaterThan = Double.parseDouble(aGT);</span>
			
<span class="nc" id="L91">			List&lt;Account&gt; accounts = accountRepository.getAccountsSpecial(id, lessThan, greaterThan);	</span>
			
<span class="nc bnc" id="L93" title="All 2 branches missed.">			if (stringId == null) {</span>
<span class="nc" id="L94">				throw new RealtorNotFoundException(realtorWithIdOf + id + wasNotFound);</span>
			}
			
<span class="nc bnc" id="L97" title="All 2 branches missed.">			if (accounts == null) {</span>
<span class="nc" id="L98">				throw new AccountNotFoundException(&quot;There are no accounts in the database&quot;);</span>
			}
			
<span class="nc" id="L101">			return accounts;</span>
			
<span class="nc" id="L103">		} catch (NumberFormatException e) {</span>
<span class="nc" id="L104">			throw new BadParameterException(realtorIdMustBeAnIntUserProvided + stringId);</span>
		}
	}
	
	public Account getAccountById(String stringId1, String stringId2) throws DatabaseException, BadParameterException, AccountNotFoundException, RealtorNotFoundException {
		try {
<span class="nc" id="L110">			int id1 = Integer.parseInt(stringId1);</span>
<span class="nc" id="L111">			int id2 = Integer.parseInt(stringId2);</span>
			
<span class="nc" id="L113">			Account account = accountRepository.getAccountById(id1, id2);</span>
			
<span class="nc bnc" id="L115" title="All 2 branches missed.">			if (stringId1 == null) {</span>
<span class="nc" id="L116">				throw new RealtorNotFoundException(realtorWithIdOf + id1 + wasNotFound);</span>
			}
			
<span class="nc bnc" id="L119" title="All 2 branches missed.">			if (account == null) {</span>
<span class="nc" id="L120">				throw new AccountNotFoundException(accountWithIdOf + id2 + wasNotFound);</span>
			}
			
<span class="nc" id="L123">			return account;</span>
<span class="nc" id="L124">		} catch (NumberFormatException e) {</span>
<span class="nc" id="L125">			throw new BadParameterException(realtorIdAndAccountIdMustBeAnIntUserProvided + stringId1 + and + stringId2);</span>
		}
	
	}
	
	public Account updateAccount(String stringId1, String stringId2, PostAccountDTO accountDTO) throws DatabaseException, BadParameterException, RealtorNotFoundException, AccountNotFoundException, NotRealtorsAccountException {
		try {
<span class="nc" id="L132">			int id1 = Integer.parseInt(stringId1);</span>
<span class="nc" id="L133">			int id2 = Integer.parseInt(stringId2);</span>
			
<span class="nc" id="L135">			Account account = accountRepository.updateAccount(id1, id2, accountDTO);</span>
			
<span class="nc bnc" id="L137" title="All 2 branches missed.">			if (stringId1 == null) {</span>
<span class="nc" id="L138">				throw new RealtorNotFoundException(realtorWithIdOf + id1 + wasNotFound);</span>
			}
			
<span class="nc bnc" id="L141" title="All 2 branches missed.">			if (stringId2 == null) {</span>
<span class="nc" id="L142">				throw new AccountNotFoundException(accountWithIdOf + id2 + wasNotFound);</span>
			}
			
<span class="nc" id="L145">			return account;</span>
<span class="nc" id="L146">		} catch (NumberFormatException e) {</span>
<span class="nc" id="L147">			throw new BadParameterException(realtorIdAndAccountIdMustBeAnIntUserProvided + stringId1 + and + stringId2);</span>
		}
	
	}
	
	public void deleteAccount(String stringId1, String stringId2) throws DatabaseException, BadParameterException, RealtorNotFoundException, AccountNotFoundException, NotRealtorsAccountException {
		try {
<span class="nc" id="L154">			int id1 = Integer.parseInt(stringId1);</span>
<span class="nc" id="L155">			int id2 = Integer.parseInt(stringId2);</span>
			
<span class="nc" id="L157">			accountRepository.deleteAccount(id1, id2);</span>
			
<span class="nc bnc" id="L159" title="All 2 branches missed.">			if (stringId1 == null) {</span>
<span class="nc" id="L160">				throw new RealtorNotFoundException(realtorWithIdOf + id1 + wasNotFound);</span>
			}
			
<span class="nc bnc" id="L163" title="All 2 branches missed.">			if (stringId2 == null) {</span>
<span class="nc" id="L164">				throw new AccountNotFoundException(accountWithIdOf + id2 + wasNotFound);</span>
			}

<span class="nc" id="L167">		} catch (NumberFormatException e) {</span>
<span class="nc" id="L168">			throw new BadParameterException(realtorIdAndAccountIdMustBeAnIntUserProvided + stringId1 + and + stringId2);</span>
		}
	
<span class="nc" id="L171">	}</span>
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>